{"ast":null,"code":"var _class;\nimport { DatePipe } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/user-service.service\";\nimport * as i3 from \"src/app/services/car.service\";\nimport * as i4 from \"@angular/forms\";\nexport class RentalAgreementComponent {\n  constructor(router, userService, carService) {\n    this.router = router;\n    this.userService = userService;\n    this.carService = carService;\n    this.userName = this.userService.getUserNameFromToken();\n    console.log(this.userName);\n    this.router.params.subscribe(params => {\n      console.log(params);\n      this.carId = params['carId'];\n      this.startDate = params['startDate'];\n      this.endDate = params['endDate'];\n      const startDateToDateTime = new Date(this.startDate);\n      const endDateToDateTime = new Date(this.endDate);\n      const timeDifference = endDateToDateTime.getTime() - startDateToDateTime.getTime();\n      this.rentalDuration = Math.ceil(timeDifference / (1000 * 24 * 3600));\n      const datePipe = new DatePipe('en-US');\n      this.currentDate = datePipe.transform(new Date(), 'yyyy-MM-dd');\n      console.log(this.startDate);\n      console.log(this.endDate);\n    });\n  }\n  ngOnInit() {\n    this.carService.getCarById(this.carId).subscribe(res => {\n      this.carDetails = res;\n      const numericPrice = parseFloat(this.carDetails.rentalPrice.replace('$', ''));\n      this.totalCost = numericPrice * this.rentalDuration;\n    }, error => {\n      console.log(error);\n    });\n  }\n  onBook() {\n    const checkBooking = {\n      startDate: \"\",\n      endDate: \"\",\n      carId: 0\n    };\n    checkBooking.startDate = this.startDate;\n    checkBooking.endDate = this.endDate;\n    checkBooking.carId = this.carId;\n    this.carService.checkBooking(checkBooking).subscribe(res => {\n      if (res === true) {\n        alert(\"Car already booked for the selected date\");\n      } else {}\n    }, error => {\n      console.log(error);\n    });\n  }\n  updateTotalCost() {\n    if (this.carDetails && this.endDate && this.startDate) {\n      const startDateToDateTime = new Date(this.startDate);\n      const endDateToDateTime = new Date(this.endDate);\n      const timeDifference = endDateToDateTime.getTime() - startDateToDateTime.getTime();\n      this.rentalDuration = Math.ceil(timeDifference / (1000 * 24 * 3600));\n      const numericPrice = parseFloat(this.carDetails.rentalPrice.replace('$', ''));\n      this.totalCost = numericPrice * this.rentalDuration;\n    }\n  }\n}\n_class = RentalAgreementComponent;\n_class.ɵfac = function RentalAgreementComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.UserServiceService), i0.ɵɵdirectiveInject(i3.CarService));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-rental-agreement\"]],\n  decls: 34,\n  vars: 8,\n  consts: [[1, \"card\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"table\", \"table-striped\"], [\"type\", \"date\", \"value\", \"startDate\", 3, \"ngModel\", \"min\", \"ngModelChange\"], [\"type\", \"date\", \"value\", \"endDate\", 3, \"ngModel\", \"min\", \"ngModelChange\"], [1, \"btn\", \"btn-primary\", 3, \"click\"]],\n  template: function RentalAgreementComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h5\", 2);\n      i0.ɵɵtext(3, \"Car Agreement\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"table\", 3)(5, \"thead\")(6, \"tr\")(7, \"th\");\n      i0.ɵɵtext(8, \"User Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"th\");\n      i0.ɵɵtext(10, \"Car Maker\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"th\");\n      i0.ɵɵtext(12, \"Car Model\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"th\");\n      i0.ɵɵtext(14, \"Total Cost\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"th\");\n      i0.ɵɵtext(16, \"Start Date\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"th\");\n      i0.ɵɵtext(18, \"End Date\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(19, \"tbody\")(20, \"td\");\n      i0.ɵɵtext(21);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"td\");\n      i0.ɵɵtext(23);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"td\");\n      i0.ɵɵtext(25);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"td\");\n      i0.ɵɵtext(27);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"td\")(29, \"input\", 4);\n      i0.ɵɵlistener(\"ngModelChange\", function RentalAgreementComponent_Template_input_ngModelChange_29_listener($event) {\n        return ctx.startDate = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(30, \"td\")(31, \"input\", 5);\n      i0.ɵɵlistener(\"ngModelChange\", function RentalAgreementComponent_Template_input_ngModelChange_31_listener($event) {\n        return ctx.endDate = $event;\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(32, \"a\", 6);\n      i0.ɵɵlistener(\"click\", function RentalAgreementComponent_Template_a_click_32_listener() {\n        return ctx.onBook();\n      });\n      i0.ɵɵtext(33, \"Book\");\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(21);\n      i0.ɵɵtextInterpolate(ctx.userName);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.carDetails.maker);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.carDetails.model);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"Rental Price * Rental Duration(days)=\", ctx.totalCost, \"\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngModel\", ctx.startDate)(\"min\", ctx.currentDate);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngModel\", ctx.endDate)(\"min\", ctx.currentDate);\n    }\n  },\n  dependencies: [i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["DatePipe","RentalAgreementComponent","constructor","router","userService","carService","userName","getUserNameFromToken","console","log","params","subscribe","carId","startDate","endDate","startDateToDateTime","Date","endDateToDateTime","timeDifference","getTime","rentalDuration","Math","ceil","datePipe","currentDate","transform","ngOnInit","getCarById","res","carDetails","numericPrice","parseFloat","rentalPrice","replace","totalCost","error","onBook","checkBooking","alert","updateTotalCost","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\ayushpal\\Dotnet-MiniAssignment\\Frontend\\car-rental-system\\src\\app\\components\\rental-agreement\\rental-agreement.component.ts","C:\\Users\\ayushpal\\Dotnet-MiniAssignment\\Frontend\\car-rental-system\\src\\app\\components\\rental-agreement\\rental-agreement.component.html"],"sourcesContent":["import { DatePipe } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { CarService } from 'src/app/services/car.service';\nimport { UserServiceService } from 'src/app/services/user-service.service';\n\n@Component({\n  selector: 'app-rental-agreement',\n  templateUrl: './rental-agreement.component.html',\n  styleUrls: ['./rental-agreement.component.css']\n})\nexport class RentalAgreementComponent implements OnInit {\n  carId:any;\n  startDate:any;\n  endDate:any;\n  userName:any\n  rentalDuration:any\n  totalCost:any\n  carDetails:any\n  currentDate:any\n  constructor(private router:ActivatedRoute,private userService:UserServiceService,private carService:CarService){\n    this.userName=this.userService.getUserNameFromToken();\n    console.log(this.userName);\n    this.router.params.subscribe(params=>{\n      console.log(params);\n      this.carId=params['carId'];\n      this.startDate=params['startDate'];\n      this.endDate=params['endDate'];\n      const startDateToDateTime=new Date(this.startDate);\n      const endDateToDateTime=new Date(this.endDate);\n      const timeDifference=endDateToDateTime.getTime()-startDateToDateTime.getTime();\n      this.rentalDuration=Math.ceil(timeDifference/(1000*24*3600));\n      const datePipe = new DatePipe('en-US');\n    this.currentDate=datePipe.transform(new Date(),'yyyy-MM-dd');\n    console.log(this.startDate)\n    console.log(this.endDate)\n  })\n}\n  ngOnInit(): void {\n    this.carService.getCarById(this.carId).subscribe((res)=>{\n     this.carDetails=res;\n     const numericPrice=parseFloat(this.carDetails.rentalPrice.replace('$',''));\n     this.totalCost=numericPrice*this.rentalDuration;\n    },\n    (error)=>{\n      console.log(error);\n    })\n    \n  }\n  onBook(){\n    const checkBooking={startDate:\"\",endDate:\"\",carId:0};\n    checkBooking.startDate=this.startDate;\n    checkBooking.endDate=this.endDate;\n    checkBooking.carId=this.carId;\n    this.carService.checkBooking(checkBooking).subscribe((res)=>{\n      if(res===true){\n        alert(\"Car already booked for the selected date\");\n      }\n      else{\n\n      }\n    },(error)=>{\n      console.log(error);\n    })\n  }\n  updateTotalCost() {\n    if (this.carDetails && this.endDate && this.startDate) {\n      const startDateToDateTime = new Date(this.startDate);\n      const endDateToDateTime = new Date(this.endDate);\n      const timeDifference = endDateToDateTime.getTime() - startDateToDateTime.getTime();\n      this.rentalDuration = Math.ceil(timeDifference / (1000 * 24 * 3600));\n      const numericPrice = parseFloat(this.carDetails.rentalPrice.replace('$', ''));\n      this.totalCost = numericPrice * this.rentalDuration;\n    }\n  }\n}\n \n  \n","<div class=\"card\">\n    \n    <div class=\"card-body\">\n      <h5 class=\"card-title\">Car Agreement</h5>\n      <table class=\"table table-striped\">\n        <thead>\n          <tr>\n            <th>User Email</th>\n            <th>Car Maker</th>\n            <th>Car Model</th>\n            <th>Total Cost</th>\n            <th>Start Date</th>\n            <th>End Date</th>\n          </tr>\n        </thead>\n        <tbody>\n          <td>{{userName}}</td>\n          <td>{{carDetails.maker}}</td>\n          <td>{{carDetails.model}}</td>\n          <td>Rental Price * Rental Duration(days)={{totalCost}}</td>\n          <td><input type=\"date\" [(ngModel)]=\"startDate\" [min]=\"currentDate\" value=\"startDate\"></td>\n          <td><input type=\"date\" [(ngModel)]=\"endDate\" [min]=\"currentDate\" value=\"endDate\"></td>\n        </tbody>\n      </table>\n      <a class=\"btn btn-primary\" (click)=\"onBook()\">Book</a>\n    </div>\n  </div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}